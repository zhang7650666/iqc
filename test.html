<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>jQuery 之 HTML 生成 Word 文档</title>
    
<link rel="stylesheet" type="text/css"
href="http://cdn.datatables.net/1.10.15/css/jquery.dataTables.css">
<link rel="stylesheet" type="text/css"
href="https://cdn.datatables.net/buttons/1.5.6/css/buttons.dataTables.min.css">
<!-- jQuery -->
<script type="text/javascript" charset="utf8"
  src="http://code.jquery.com/jquery-1.10.2.min.js"></script>

<!-- DataTables -->
<script type="text/javascript" charset="utf8"
  src="http://cdn.datatables.net/1.10.15/js/jquery.dataTables.js"></script>

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.18/b-1.5.6/b-flash-1.5.6/b-html5-1.5.6/datatables.min.css"/>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.18/b-1.5.6/b-flash-1.5.6/b-html5-1.5.6/datatables.min.js"></script>
</head>
<body>
    <div class="row">
        <div class="col-md-12 col-sm-12">
            <!-- BEGIN EXAMPLE TABLE PORTLET-->
            <div class="portlet box blue-hoki">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="fa fa-list"></i>数据列表
                    </div>
                    <div class="tools">
                    </div>
                </div>
                <div class="portlet-body">
                    <table id="myTable" class="table table-striped table-bordered table-hover"
                           style="width:100%">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Position</th>
                            <th>Office</th>
                            <th>Age</th>
                            <th>Start date</th>
                            <th>Salary</th>
                        </tr>
                        <tr>
                            <th>Name111</th>
                            <th>Position111</th>
                            <th>Office111</th>
                            <th>Age111</th>
                            <th>Start date111</th>
                            <th>Salary111</th>
                        </tr>
                        </thead>
                        <tbody>
     
     
                        <tr>
                            <td>Airi Satou</td>
                            <td>Accountant</td>
                            <td>Tokyo</td>
                            <td>33</td>
                            <td>2008/11/28</td>
                            <td>CHECKBOX162,700</td>
                        </tr>
                        <tr>
                            <td>Brielle Williamson</td>
                            <td>Integration Specialist</td>
                            <td>New York</td>
                            <td>61</td>
                            <td>2012/12/02</td>
                            <td>CHECKBOX372,000</td>
                        </tr>
                        <tr>
                            <td>Herrod Chandler</td>
                            <td>Sales Assistant</td>
                            <td>San Francisco</td>
                            <td>59</td>
                            <td>2012/08/06</td>
                            <td>CHECKBOX137,500</td>
                        </tr>
     
                        <tr>
                            <td>Jonas Alexander</td>
                            <td>Developer</td>
                            <td>San Francisco</td>
                            <td>30</td>
                            <td>2010/07/14</td>
                            <td>CHECKBOX86,500</td>
                        </tr>
                        <tr>
                            <td>Shad Decker</td>
                            <td>Regional Director</td>
                            <td>Edinburgh</td>
                            <td>51</td>
                            <td>2008/11/13</td>
                            <td>CHECKBOX183,000</td>
                        </tr>
                        <tr>
                            <td>Michael Bruce</td>
                            <td>Javascript Developer</td>
                            <td>Singapore</td>
                            <td>29</td>
                            <td>2011/06/27</td>
                            <td>CHECKBOX183,000</td>
                        </tr>
                        <tr>
                            <td>Donna Snider</td>
                            <td>Customer Support</td>
                            <td>New York</td>
                            <td>27</td>
                            <td>2011/01/25</td>
                            <td><input type="checkbox"></td>
                        </tr>
                        </tbody>
                        <tfoot>
                        <tr>
                            <th>Name</th>
                            <th>Position</th>
                            <th>Office</th>
                            <th>Age</th>
                            <th>Start date</th>
                            <th><input type="checkbox"></th>
                        </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <button id="leading-out">导出 Word</button>
</body>


<script>
    $(document).ready(function () {
      var table = $('#myTable').DataTable({
        dom: 'Bfrtip',
        buttons: [
          {
              extend: 'excel',
            //   exportOptions: {
            //     orthogonal: 'sort'
            // }
          }
          
        ],
        // buttons: [
        //   'copyHtml5',
        //   'excel',
        //   'csvHtml5',
        //   'pdfHtml5',
          
        // ],
        columnDefs:[
            {
                targets: [0, 5],
                render: function(data, type, row, meta) {
                    console.log(6666, data, type)
                    // if(type === 'sort') {
                        var $input = $(data).find('input[type="checkbox"]').addBack();
                        data = ($input.prop('checked')) ? '1': '0'
                    // }
                    return data;
                }
            }
        ]
      });

      table.buttons().container().appendTo($('.col-sm-6:eq(0)', table.table().container()))
    });
  </script>
</html>